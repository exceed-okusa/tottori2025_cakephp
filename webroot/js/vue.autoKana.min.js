(function($){$.fn.vueAutoKana=function(passedOptions){let elName,active=false,timer=[],flagConvert=true,input,values,ignoreString,baseKana;var options=$.extend({vueObj:null,targetItem:"",katakana:false},passedOptions);let methods={change:function(){input=eval("options.vueObj."+options.targetItem)}};if(methods[passedOptions]){return methods[passedOptions].apply(this,Array.prototype.slice.call(arguments,1))}let kana_extraction_pattern=new RegExp("[^ 　ぁあ-んー]","g");let kana_compacting_pattern=new RegExp("[ぁぃぅぇぉっゃゅょ]","g");elName=this;active=true;_stateClear();elName.blur(_eventBlur);elName.focus(_eventFocus);elName.keydown(_eventKeyDown);$.fn.vueAutoKana.start=function(){active=true};$.fn.vueAutoKana.stop=function(){input=elName.val();baseKana="";values=splitByLength(eval("options.vueObj."+options.targetItem),1)};function splitByLength(str,length){var resultArr=[];if(!str||!length||length<1){return resultArr}var index=0;var start=index;var end=start+length;while(start<str.length){resultArr[index]=str.substring(start,end);index++;start=end;end=start+length}return resultArr}function start(){active=true}function stop(){baseKana="";active=false}function toggle(event){var ev=event||window.event;if(event){var el=Event.element(event);if(el.checked){active=true}else{active=false}}else{active=!active}}function _checkConvert(new_values){if(!flagConvert){if(Math.abs(values.length-new_values.length)>1){var tmp_values=new_values.join("").replace(kana_compacting_pattern,"").split("");if(Math.abs(values.length-tmp_values.length)>1){_stateConvert()}}else{if(values.length==input.length&&values.join("")!=input){if(input.match(kana_extraction_pattern)){_stateConvert()}}}}}var _checkValue=function(){var new_input,new_values;new_input=elName.val();if(new_input==""){_stateClear();_setKana()}else{new_input=_removeString(new_input);if(input==new_input){return}else{input=new_input;if(!flagConvert){new_values=new_input.replace(kana_extraction_pattern,"").split("");_checkConvert(new_values);_setKana(new_values)}}}};function _clearInterval(){clearInterval(timer)}function _eventBlur(event){_clearInterval()}function _eventFocus(event){_stateInput();_setInterval()}function _eventKeyDown(event){if(flagConvert){_stateInput()}}function _isHiragana(chara){return((chara>=12353&&chara<=12435)||chara==12445||chara==12446)}function _removeString(new_input){if(new_input.indexOf(ignoreString)!==-1){return new_input.replace(ignoreString,"")}else{var i,ignoreArray,inputArray;ignoreArray=ignoreString.split("");inputArray=new_input.split("");for(i=0;i<ignoreArray.length;i++){if(ignoreArray[i]==inputArray[i]){inputArray[i]=""}}return inputArray.join("")}}function _setInterval(){var self=this;timer=setInterval(_checkValue,30)}function _setKana(new_values){if(!flagConvert){if(new_values){values=new_values}if(active){var _val=_toKatakana(baseKana+values.join(""));eval("options.vueObj."+options.targetItem+"= _val")}}}function _stateClear(){baseKana="";flagConvert=false;ignoreString="";input="";values=[]}function _stateInput(){baseKana=eval("options.vueObj."+options.targetItem);flagConvert=false;ignoreString=elName.val()}function _stateConvert(){baseKana=baseKana+values.join("");flagConvert=true;values=[]}function _toKatakana(src){if(options.katakana){var c,i,str;str="";for(i=0;i<src.length;i++){c=src.charCodeAt(i);if(_isHiragana(c)){str+=String.fromCharCode(c+96)}else{str+=src.charAt(i)}}return str}else{return src}}}})(jQuery);(function($){$.fn.vueAutoKana2=function(passedOptions){let elName,active=false,timer=[],flagConvert=true,input,values,ignoreString,baseKana;var options=$.extend({vueObj:null,targetItem:"",katakana:false},passedOptions);let methods={change:function(){input=eval("options.vueObj."+options.targetItem)}};if(methods[passedOptions]){return methods[passedOptions].apply(this,Array.prototype.slice.call(arguments,1))}let kana_extraction_pattern=new RegExp("[^ 　ぁあ-んー]","g");let kana_compacting_pattern=new RegExp("[ぁぃぅぇぉっゃゅょ]","g");elName=this;active=true;_stateClear();elName.blur(_eventBlur);elName.focus(_eventFocus);elName.keydown(_eventKeyDown);$.fn.vueAutoKana2.start=function(){active=true};$.fn.vueAutoKana2.stop=function(){input=elName.val();baseKana="";values=splitByLength(eval("options.vueObj."+options.targetItem),1)};function splitByLength(str,length){var resultArr=[];if(!str||!length||length<1){return resultArr}var index=0;var start=index;var end=start+length;while(start<str.length){resultArr[index]=str.substring(start,end);index++;start=end;end=start+length}return resultArr}function start(){active=true}function stop(){baseKana="";active=false}function toggle(event){var ev=event||window.event;if(event){var el=Event.element(event);if(el.checked){active=true}else{active=false}}else{active=!active}}function _checkConvert(new_values){if(!flagConvert){if(Math.abs(values.length-new_values.length)>1){var tmp_values=new_values.join("").replace(kana_compacting_pattern,"").split("");if(Math.abs(values.length-tmp_values.length)>1){_stateConvert()}}else{if(values.length==input.length&&values.join("")!=input){if(input.match(kana_extraction_pattern)){_stateConvert()}}}}}var _checkValue=function(){var new_input,new_values;new_input=elName.val();if(new_input==""){_stateClear();_setKana()}else{new_input=_removeString(new_input);if(input==new_input){return}else{input=new_input;if(!flagConvert){new_values=new_input.replace(kana_extraction_pattern,"").split("");_checkConvert(new_values);_setKana(new_values)}}}};function _clearInterval(){clearInterval(timer)}function _eventBlur(event){_clearInterval()}function _eventFocus(event){_stateInput();_setInterval()}function _eventKeyDown(event){if(flagConvert){_stateInput()}}function _isHiragana(chara){return((chara>=12353&&chara<=12435)||chara==12445||chara==12446)}function _removeString(new_input){if(new_input.indexOf(ignoreString)!==-1){return new_input.replace(ignoreString,"")}else{var i,ignoreArray,inputArray;ignoreArray=ignoreString.split("");inputArray=new_input.split("");for(i=0;i<ignoreArray.length;i++){if(ignoreArray[i]==inputArray[i]){inputArray[i]=""}}return inputArray.join("")}}function _setInterval(){var self=this;timer=setInterval(_checkValue,30)}function _setKana(new_values){if(!flagConvert){if(new_values){values=new_values}if(active){var _val=_toKatakana(baseKana+values.join(""));eval("options.vueObj."+options.targetItem+"= _val")}}}function _stateClear(){baseKana="";flagConvert=false;ignoreString="";input="";values=[]}function _stateInput(){baseKana=eval("options.vueObj."+options.targetItem);flagConvert=false;ignoreString=elName.val()}function _stateConvert(){baseKana=baseKana+values.join("");flagConvert=true;values=[]}function _toKatakana(src){if(options.katakana){var c,i,str;str="";for(i=0;i<src.length;i++){c=src.charCodeAt(i);if(_isHiragana(c)){str+=String.fromCharCode(c+96)}else{str+=src.charAt(i)}}return str}else{return src}}}})(jQuery);